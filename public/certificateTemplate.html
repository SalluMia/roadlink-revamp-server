<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Certificate</title>
    <style>
        @page {
            size: 15.60in 11.03in;
            margin: 0;
        }

        body {
            width: 15.60in;
            height: 11.03in;
            margin: 0;
            font-family: Arial, sans-serif;
            padding: 15px;
            box-sizing: border-box;
        }

        .container {
            width: 100%;
            position: relative;
            z-index: 1;
            background-color: white;
        }

        .container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: url('https://www.roadslink.in/api/watermark.jpeg');
            background-position: center;
            opacity: 0.04;
            z-index: -1;
        }

        .topbar-row { display: flex; }
        .firstcol-6, .secondcol-6 { flex: 1; }
        .firstcol-6 { background-color: black; }
        .secondcol-6 { background-color: orange; }
        
        .rightlogocol-6, .leftlogocol-6 { flex: 1; }
        
        .tests {
            display: flex; 
            width: 50%; 
            border-bottom: 5px solid black; 
            justify-content: space-between; 
            margin: 15px auto;
        }
        
        .RTA-psyc, .RTA-eng {
            flex: 1;
            font-size: 20px;
            font-family: 'Times New Roman', Times, serif;
            margin-bottom: 10px;
        }
        
        .scores {
            display: flex; 
            width: 70%;  
            justify-content: center; 
            gap: 250px; 
            margin: 0 auto;
            font-size: 20px;
        }
        
        .percentages {
            display: flex; 
            width: 35%;  
            justify-content: space-between; 
            margin: 0 auto;
            font-size: 20px;
        }

        .bottom-row { display: flex; }
        .bottom-left-6, .bottom-right-6 {
            flex: 1;
            height: 15px;
        }
        .bottom-right-6 { background-color: black; }
        .bottom-left-6 { background-color: orange; }
        
        .certificate-content {
            text-align: center;
            margin-top: 50px;
        }

        .stamps-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin: 20px 0;
            padding: 0 20px;
        }

        .stamps-row .stamp-logo img,
        .stamps-row .qr-code img {
            width: 230px;
            height: 230px;
            margin-left: 50px;
        }

        .verification-section {
            width: 500px;
            height: 140px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            margin: 0 auto;
            text-align: center;
            background-image: url("data:image/svg+xml,%3csvg width='100%25' height='100%25' xmlns='http://www.w3.org/2000/svg'%3e%3crect width='100%25' height='100%25' fill='none' rx='14' ry='14' stroke='%23333' stroke-width='4' stroke-dasharray='28%2c 18' stroke-dashoffset='100' stroke-linecap='butt'/%3e%3c/svg%3e");
            border-radius: 14px;
        }
        
        .verification-section p { margin: 0; }

        .footer-certificate {
            margin-top: 30px;
            padding: 0 !important;
        }

        .footer-certificate .row {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            gap: 20px;
        }

        .footer-certificate .col-sm-2,
        .footer-certificate .col-sm-3,
        .footer-certificate .col-sm-4 {
            flex: 1;
            margin: 0;
        }

        .footer-certificate .col-sm-3,
        .footer-certificate .col-sm-4 {
            flex: 2;
        }
        
        .footer-certificate .col-sm-4 {
            margin-top: 7px;
        }

        .footer-certificate .col-sm-4 img {
            width: 70%;
        }

        .footer-certificate .separator {
            height: 1px;
            background: black;
            margin-top: 3px; 
        }
        
        .footer-certificate #p-tag {
            font-size: 16px !important;
            margin-top: 2px !important;
            padding-top: 2px !important;   
        }

        .topbar-row, .bottom-row {
            display: flex;
        }

        .topbar-row > div,
        .bottom-row > div {
            flex: 1;
            height: 20px;
        }

    </style>
</head>
<body>
    <div class="container">
        <!-- Border -->
        <div class="topbar-row">
            <div class="firstcol-6"></div>
            <div class="secondcol-6"></div>
        </div>

        <!-- Logo -->
        <div class="logos-row" style="display: flex;">
            <div class="leftlogocol-6">
                <img src="https://www.roadslink.in/api/logo.jpeg" alt="Logo 1" style="height: 80px;" />
            </div>
            <div class="rightlogocol-6" style="text-align: end;">
                <img src="https://www.roadslink.in/api/roadsTransport.png" alt="Logo 2" style="width: 480px;" />
            </div>
        </div>

        <!-- Category -->
        <div class="row">
            <div class="col-12">
                <div class="category" style="margin-left: 20px;">
                    <h2 style="font-size: 25px !important; font-family: 'Times New Roman', Times, serif; font-weight: 600; font-size: larger; margin-bottom: 0;">
                        Category: <span style="font-weight: normal; margin-bottom: 0 !important;"><%= employee.category %></span>
                    </h2>
                    <hr style="height: 4px; background-color: #000; width: 270px; margin-left: 0; margin: 0;">
                </div>
            </div>
        </div>

        <!-- Certificate Content -->
        <div class="certificate-content">
            <div class="title">
                <h4 style="font-family: 'Times New Roman', Times, serif; font-weight: 500; font-size: 30px !important; margin-bottom: 24px;">This certificate is proudly presented to</h4>
                <h4 style="font-weight: medium; margin: 0; font-size: 30px !important;"><%= employee.name %></h4>
                <h4 style="font-family: 'Times New Roman', Times, serif; font-weight: 500; font-size: 30px !important; margin-top: 24px;">for the successful completion of the following courses:</h4>
            </div>
            
            <div class="tests">
                <div class="RTA-psyc">
                    <h4 style="font-weight: normal; margin: 0; font-size: 25px !important;">RTA Psychometric Tests</h4>
                </div>
                <div class="RTA-eng">
                    <h4 style="font-weight: normal; margin: 0; font-size: 25px !important;">RTA English Test</h4>
                </div>
            </div>

            <!-- Scores and Percentage -->
            <div class="scores">
                <p style="margin: 0; font-size: 25px !important;"><%= employee.rtaPsychometricTest %> out of 100</p>
                <p style="margin: 0; font-size: 25px !important;"><%= employee.rtaEnglishTest %> out of 150</p>
            </div>
            <div class="percentages">
                <p style="font-size: 25px !important;">(<%= Math.round((employee.rtaPsychometricTest / 100) * 100) %>%)</p>
                <p style="font-size: 25px !important;">(<%= Math.round((employee.rtaEnglishTest / 150) * 100) %>%)</p>
            </div>
        </div>

        <!-- Stamps Row -->
        <div class="stamps-row">
            <div class="stamp-logo">
                <img src="https://www.roadslink.in/api/stamp.jpeg" alt="Stamp">
            </div>
            <div class="verification-section">
                <p style="font-size: 20px; font-weight: 500;">Verified Certificate</p>
                <p style="font-size: 20px; font-weight: 500;">Issued by: <a href="www.roadslink.ae" style="color: #0d6efd">www.roadslink.ae</a></p>
                <p style="font-size: 20px; font-weight: 500;">
                    Please verify at:
                    <a href="www.roadslink.ae/certification" style="color: #0d6efd;">www.roadslink.ae/certification</a><br>
                    using passport number.
                </p>
            </div>
            <div class="qr-code">
                <img src="<%= qrCodeUrl %>" alt="QR Code">
            </div>
        </div>

        <!-- Footer -->
        <div class="footer-certificate">
            <div class="row">
                <div class="col-sm-4" style="margin-top: 5px !important;">
                  <div class="footer-cols" >
                    <img src="https://www.roadslink.in/api/gehadh.png" alt="Authorized Signature" style="margin-top: 8px !important;">
                    <div class="separator" style="width: 80% !important;"></div>
                    <p id="p-tag" style="font-family: 'Times New Roman', Times, serif; display: flex; width: 100%; font-weight: 600 !important;">Authorized Signature and Stamp</p>
                  </div>
                </div>
                <div class="col-sm-2" style="padding-top: 40px !important; padding-left:20px ; padding-right: 20px;">
                  <div class="footer-cols">
                    <p style="font-size: 20px; margin: 0; text-align:start; "><%= employee.certificateCode %></p>
                    <div class="separator" style="width: 85% !important;"></div>
                    <p id="p-tag" style="font-family: 'Times New Roman', Times, serif; display: flex; width: 100%; font-weight:600 !important;">Certificate Code</p>
                  </div>
                </div>
                <div class="col-sm-2" style="padding-top: 40px !important; padding-left:20px ; padding-right: 20px;">
                   <div class="footer-cols">
                    <p style="font-size: 20px; margin: 0; text-align: start; "><%= employee.studentId %></p>
                    <div class="separator" style="width: 80% !important;"></div>
                    <p id="p-tag" style="font-family: 'Times New Roman', Times, serif; display: flex; width: 100%; font-weight:600 !important;">Student ID</p>
                   </div>
                </div>
                <div class="col-sm-3" style="position: relative; height: 120px;">
                   <div class="footer-cols">
                    <div id="companyNameContainer" style="width: 80%; height: 62px; overflow: hidden;">
                        <p id="companyNameText" style="font-size: 20px; margin: 0; word-wrap: break-word; overflow-wrap: break-word; height: 62px; display: flex; justify-content: start; align-items: end; width: 100%;">
                            <%= employee.companyName %>
                        </p>
                    </div>
                    <div id="companySeparator" class="separator" style="height: 1px;margin-bottom: 5px; background-color: #000; 
                    position: absolute; top: 62px; left: 0; width: 80% !important;"></div>
                    <p id="p-tag" style="font-family: 'Times New Roman', Times, serif; margin: 0; position: absolute; top: 65px; left: 0;font-weight:600 !important; width: 100%; text-align: left;">
                        Name of the Company
                    </p>
                   </div>
                </div>
                <div class="col-sm-2" style="padding-top: 40px !important; padding-left:20px ; padding-right: 20px;">
                    <div class="footer-cols">
                        <p style="font-size: 20px; margin: 0; text-align:start; " id="formattedDate"></p>
                    <div class="separator" style="width: 80% !important;"></div>
                    <p id="p-tag" style="font-family: 'Times New Roman', Times, serif; display: flex; width: 100%; font-weight:bold;">Date</p>
                
                    </div>
                </div>
            </div>
        </div>

        <!-- Border -->
        <div class="bottom-row">
            <div class="bottom-left-6" style="background-color: orange;"></div>
            <div class="bottom-right-6" style="background-color: black;"></div>
        </div>
    </div>

    <script>
        // Format date
        const employeeDate = new Date('<%= employee.date %>');
        const formattedDate = employeeDate.toLocaleDateString('en-US', {
            day: 'numeric',
            month: 'short',
            year: 'numeric'
        });
        document.getElementById('formattedDate').innerText = formattedDate;

        // Check if company name content is wrapped and adjust separator width
        function adjustSeparatorWidth() {
            const companyNameText = document.getElementById('companyNameText');
            const companyNameContainer = document.getElementById('companyNameContainer');
            const companySeparator = document.getElementById('companySeparator');
            
            if (companyNameText && companySeparator && companyNameContainer) {
                // Create a temporary element to measure text width
                const tempElement = document.createElement('div');
                tempElement.style.cssText = `
                    position: absolute;
                    visibility: hidden;
                    white-space: nowrap;
                    font-size: 20px;
                    font-family: inherit;
                `;
                tempElement.textContent = companyNameText.textContent;
                document.body.appendChild(tempElement);
                
                // Get the width of the text without wrapping
                const textWidth = tempElement.offsetWidth;
                
                // Get the width of the container (80% of parent)
                const containerWidth = companyNameContainer.offsetWidth;
                
                // Remove the temporary element
                document.body.removeChild(tempElement);
                
                // If text width is greater than container width, content will be wrapped
                const isWrapped = textWidth > containerWidth;
                
                console.log('Text width:', textWidth, 'Container width:', containerWidth, 'Is wrapped:', isWrapped);
                
                // Set separator width to match the container width
                if (isWrapped) {
                    // If content is wrapped, use 90% to accommodate the wrapped text
                    companySeparator.style.width = '90%';
                    console.log('Content is wrapped - Setting separator width to 90%');
                } else {
                    // If content is not wrapped, use 80% to match the container
                    companySeparator.style.width = '80%';
                    console.log('Content is not wrapped - Setting separator width to 80%');
                }
            }
        }

        // Run the adjustment after the page loads
        window.addEventListener('load', adjustSeparatorWidth);
    </script>
</body>
</html>
